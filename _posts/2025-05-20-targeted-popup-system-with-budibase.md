---
title: ìœ ì € íƒ€ê²ŸíŒ… ì „ë©´ íŒì—… ì‹œìŠ¤í…œ êµ¬ì¶•í•˜ê¸° - ë¶€ë””ë² ì´ìŠ¤ í™œìš©
date: 2025-09-25
category: [ê°œë°œì¼ì§€, React Native]
tags: [React Native, ë¶€ë””ë² ì´ìŠ¤, íƒ€ê²ŸíŒ…, ì „ë©´íŒì—…, ë§ˆì¼€íŒ…ì‹œìŠ¤í…œ, ì‚¬ìš©ìê²½í—˜, ê°œë°œì¼ì§€]
---

# ë§ˆì¼€í„°ê°€ ì‚¬ë‘í•˜ëŠ” íƒ€ê²ŸíŒ… ì „ë©´ íŒì—… ì‹œìŠ¤í…œ êµ¬ì¶•ê¸° ğŸ¯

ê²Œì„ ìš´ì˜ì—ì„œ **ì „ë©´ íŒì—…**ì€ ì–‘ë‚ ì˜ ê²€ì´ë‹¤. íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ ë§¤ì¶œ ì¦ëŒ€ì™€ ì‚¬ìš©ì ì°¸ì—¬ë„ í–¥ìƒì— í° ë„ì›€ì´ ë˜ì§€ë§Œ, ì˜ëª» ì‚¬ìš©í•˜ë©´ ì‚¬ìš©ì í”¼ë¡œê°ë§Œ ì¦ê°€ì‹œí‚¨ë‹¤. ìš°ë¦¬ íŒ€ì€ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ **ì •êµí•œ íƒ€ê²ŸíŒ… ì‹œìŠ¤í…œ**ì„ êµ¬ì¶•í–ˆê³ , ê·¸ ê²½í—˜ì„ ê³µìœ í•˜ë ¤ê³  í•œë‹¤.

## ğŸ“‹ í”„ë¡œì íŠ¸ ë°°ê²½

### ë¬´ì°¨ë³„ì ì¸ íŒì—… ê³µê²©ì€ ë„ˆë¬´ ë¹„íš¨ìœ¨ì ì´ì–ì•„!
   - ëª¨ë“  ì‚¬ìš©ìì—ê²Œ ëª¨ë“  íŒì—…ì„ ë™ì¼í•˜ê²Œ ë³´ì—¬ì¤„ í•„ìš”ê°€ ìˆì„ê¹Œ?
   - íƒ€ê²Ÿì— ë§ì§€ ì•ŠëŠ” ì½˜í…ì¸ ë¡œ ì¸í•´ íŠ¹ì • ì‚¬ìš©ìëŠ” ë¶ˆì¾Œí•˜ê±°ë‚˜ í”¼ë¡œê°ì„ ëŠë‚„ ìˆ˜ ìˆë‹¤!
   - ì „í™˜ìœ¨ ì €í•˜? ë° ì´íƒˆë¥  ì¦ê°€?

## ğŸ’¡ í•´ê²° ì•„ì´ë””ì–´

**"ë§ˆì¼€í„°ê°€ ì§ì ‘ ì¡°ê±´ì„ ì„¤ì •í•˜ê³ , ì‹œìŠ¤í…œì´ ìë™ìœ¼ë¡œ íƒ€ê²ŸíŒ…í•´ì„œ ë…¸ì¶œí•˜ì!"**

### í•µì‹¬ ì»¨ì…‰

- **ì •êµí•œ íƒ€ê²ŸíŒ…**: ì‹œê°„, ìš”ì¼, ë ˆë²¨, ë…¸ì¶œíšŸìˆ˜ ë“± ë‹¤ì°¨ì› ì¡°ê±´
- **ë…¸ì½”ë“œ ê´€ë¦¬**: ë¶€ë””ë² ì´ìŠ¤ë¡œ ë§ˆì¼€í„°ê°€ ì§ì ‘ ê´€ë¦¬
- **ë°ì´í„° ê¸°ë°˜**: ì‹¤ì‹œê°„ ì¡°ê±´ ê²€ì¦ ë° ë…¸ì¶œ ì œì–´
- **ì¦‰ì‹œ ë°˜ì˜**: ì½”ë“œ ë°°í¬ ì—†ì´ ì‹¤ì‹œê°„ ì ìš©

## ğŸ— ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 1. ë¶€ë””ë² ì´ìŠ¤ ë°ì´í„° êµ¬ì¡°ëŠ” ì–´ë–»ê²Œ ì„¤ê³„í•´ì•¼í• ê¹Œ?

```javascript
// ë¶€ë””ë² ì´ìŠ¤ íŒì—… ë°ì´í„° ì˜ˆì‹œ
const popupData = {
	theme: 'christmas_event', // íŒì—… ì‹ë³„ì
	main_image: [
		{
			url: 'https://cdn.example.com/popup.jpg',
			name: 'í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ì´ë²¤íŠ¸',
		},
	],
	info: {
		level: { value: 5, type: 'over' }, // 5ë ˆë²¨ ì´ˆê³¼
		water_pot: { value: 10, type: 'under' }, // ë¬¼ë¿Œë¦¬ê°œ 10ê°œ ë¯¸ë§Œ
		nutrient: { value: 50, type: 'equal' }, // ì˜ì–‘ë¶„ ì •í™•íˆ 50
	},
	repeat_days: ['Mon', 'Tue', 'Wed'], // ì›”,í™”,ìˆ˜ë§Œ ë…¸ì¶œ
	repeat_start_time: '0900', // ì˜¤ì „ 9ì‹œë¶€í„°
	repeat_end_time: '1800', // ì˜¤í›„ 6ì‹œê¹Œì§€
	impressions: 3, // í•˜ë£¨ ìµœëŒ€ 3íšŒ ë…¸ì¶œ
	button_landing_type: 'route', // í´ë¦­ ì‹œ ì´ë™ íƒ€ì…
	button_landing: 'EventScreen', // ì´ë™í•  í™”ë©´
	start_at: '2025-12-20', // ì‹œì‘ì¼
	end_at: '2025-12-31', // ì¢…ë£Œì¼
}
```

### 2. íƒ€ê²ŸíŒ… ì¡°ê±´ ê²€ì¦ ë¡œì§ì€ ì–´ë–»ê²Œ êµ¬í˜„í•´ì•¼í• ê¹Œ?

ê°€ì¥ í•µì‹¬ì¸ íƒ€ê²ŸíŒ… ì¡°ê±´ ê²€ì¦ ë¡œì§ì„ êµ¬í˜„í–ˆë‹¤.
ìœ ì €ì˜ ë†ì¥ ì‘ë¬¼ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œí•œ ë°ì´í„° ê²€ì¦ì´ ìš°ì„ ì´ê³ ,
ìš”ì¼ê³¼ ì‹œê°„ëŒ€ ì¡°ê±´ë„ ê²€ì¦í•˜ë„ë¡ í–ˆë‹¤. (ì‚¬ì‹¤ ì´ ì‹œê°„ëŒ€ëŠ” ë°˜ë³µ ì‹œê°„ëŒ€ë¥¼ ì˜ë¯¸í•˜ê³  ì´ë¯¸ visible ë˜ëŠ” ì‹œê°„ëŒ€ëŠ” ì—”ë“œí¬ì¸íŠ¸ ìª½ì—ì„œ í•„í„°ë§ì´ ëœë‹¤.)

```javascript
const validateTargetingConditions = (popupData, userFarmData, currentTime) => {
	const { info = {}, repeat_days, repeat_start_time, repeat_end_time } = popupData
	const { level, water_pot, normal_fertilizer, good_fertilizer, nutrient } = userFarmData

	let conditionChecks = []

	// 1. ë†ì¥ ìƒíƒœ ì¡°ê±´ ê²€ì¦
	Object.keys(info).forEach(key => {
		const condition = info[key]
		const userValue = userFarmData[key]

		switch (condition.type) {
			case 'equal':
				conditionChecks.push(userValue === condition.value ? 1 : 0)
				break
			case 'under':
				conditionChecks.push(userValue < condition.value ? 1 : 0)
				break
			case 'over':
				conditionChecks.push(userValue > condition.value ? 1 : 0)
				break
		}
	})

	// 2. ìš”ì¼ ì¡°ê±´ ê²€ì¦
	if (repeat_days?.length > 0) {
		const todayIndex = dayjs().day()
		const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']
		const todayName = dayNames[todayIndex]
		const isValidDay = repeat_days.includes(todayName)
		conditionChecks.push(isValidDay ? 1 : 0)
	}

	// 3. ì‹œê°„ëŒ€ ì¡°ê±´ ê²€ì¦
	if (repeat_start_time && repeat_end_time) {
		const currentTime = dayjs().format('HHmm')
		const isValidTime =
			Number(currentTime) >= Number(repeat_start_time) &&
			Number(currentTime) <= Number(repeat_end_time)
		conditionChecks.push(isValidTime ? 1 : 0)
	}

	// ëª¨ë“  ì¡°ê±´ì´ ë§Œì¡±ë˜ì–´ì•¼ í•¨
	return conditionChecks.every(check => check === 1)
}
```

### 3. ë§¤ì¼ ë…¸ì¶œë˜ë©´ ê·¸ê²ƒ ë˜í•œ í”¼ë¡œí•˜ë‹¤!

ìœ ì €ë§ˆì ë…¸ì¶œë˜ëŠ” íšŸìˆ˜ë„ ì œí•œí•´ì„œ ì ë‹¹íˆ ì„ ì„ ë„˜ì§€ì•Šê²Œ(?) ë…¸ì¶œí•´ë³´ì.
ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— í•´ë‹¹ íŒì—…ì˜ ê³ ìœ í•œ í…Œë§ˆ String ê°’ê³¼ impressions ìˆ˜ë¥¼ ì €ì¥í•´ë†“ê³ ,
ë…¸ì¶œì´ ë ë•Œë§ˆë‹¤ í•˜ë‚˜ì”© ì¦ê°€ì‹œí‚¤ê³ , ìµœëŒ€ ë…¸ì¶œ íšŸìˆ˜ë¥¼ ì´ˆê³¼í•˜ë©´ ë…¸ì¶œí•˜ì§€ ì•ŠëŠ”ë‹¤.

```javascript
const manageImpressionLimit = async (popupList, maxImpressions) => {
	// ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë…¸ì¶œ ê¸°ë¡ ì¡°íšŒ
	const impressionHistory = JSON.parse(await AsyncStorage.getItem(FARM_POPUP_SHOW_INFO)) || []

	const today = dayjs().format('YYYY-MM-DD')

	// ì˜¤ëŠ˜ ë…¸ì¶œ ê°€ëŠ¥í•œ íŒì—…ë“¤ í•„í„°ë§
	const availablePopups = popupList.filter(popup => {
		const history = impressionHistory.find(h => h.theme === popup.theme)

		// ê¸°ë¡ì´ ì—†ê±°ë‚˜, í•˜ë£¨ê°€ ì§€ë‚¬ê±°ë‚˜, ë…¸ì¶œ íšŸìˆ˜ê°€ ì œí•œë³´ë‹¤ ì ì€ ê²½ìš°
		if (!history) return true

		const isDifferentDay = dayjs().diff(history.date, 'day') >= 1
		if (isDifferentDay) return true

		return history.impressions < popup.impressions
	})

	return availablePopups
}
```

### 4. React Hookìœ¼ë¡œ êµ¬í˜„í•´ì„œ ì–´ë””ì„œë“  ì „ë©´íŒì—…ì„ ì‰½ê²Œ ë…¸ì¶œí•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•´ë³´ì.

```javascript
const useFarmFrontPopup = () => {
	const [popupList, setPopupList] = useState([])
	const [visiblePopupList, setVisiblePopupList] = useState(null)

	// ë¶€ë””ë² ì´ìŠ¤ì—ì„œ íŒì—… ë°ì´í„° ì¡°íšŒ
	const fetchPopupData = useCallback(async () => {
		const rawData = await farmApi.farmManager.getFarmPopup[1]({ // budibase API í˜¸ì¶œ
			env: getAppEnv(),
			visible: true,
			is_equal_search: true,
			ongoing_start_col_name: 'start_at',
			ongoing_end_col_name: 'end_at',
		})

		// í˜„ì¬ ë†ì¥ ìƒíƒœ ì¡°íšŒ
		const farmData = await farmApi.farm.getMy[1]({})
		const { user_crop, warehouse } = farmData

		const currentUserData = {
			level: user_crop?.level,
			water_pot: warehouse?.water_pot,
			n_fertilizer: warehouse?.n_fertilizer,
			g_fertilizer: warehouse?.g_fertilizer,
			nutrient: user_crop?.nutrient,
		}

		// ì¡°ê±´ì— ë§ëŠ” íŒì—…ë“¤ë§Œ í•„í„°ë§
		const targetedPopups = rawData.filter(popup =>
			validateTargetingConditions(popup, currentUserData, dayjs())
		)

		setVisiblePopupList(targetedPopups)
	}, [])

	// íŒì—… ë…¸ì¶œ ì‹¤í–‰
	const showFarmFrontPopup = useCallback(async () => {
		try {
			const availablePopups = await manageImpressionLimit(visiblePopupList)
			if (!availablePopups.length) return

			const targetPopup = availablePopups[0]

			// ë…¸ì¶œ ê¸°ë¡ ì—…ë°ì´íŠ¸
			await updateImpressionHistory(targetPopup.theme)

			// í†µê³„ ì „ì†¡
			sendShowStatistics(targetPopup)

			// íŒì—… í‘œì‹œ
			setFarmFrontPopup(targetPopup)
		} catch (error) {
			console.error('íŒì—… ë…¸ì¶œ ì˜¤ë¥˜:', error)
		}
	}, [visiblePopupList])

	return {
		data: popupList,
		visibleList: visiblePopupList,
		show: showFarmFrontPopup,
	}
}
```

## ğŸ¯ ë§ˆì¼€í„° ì¹œí™”ì ìœ¼ë¡œ êµ¬í˜„í•˜ê¸°ìœ„í•´ì„œëŠ” ì§ê´€ì ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆê²Œ í•´ì•¼í•œë‹¤!

ë¶€ë””ë² ì´ìŠ¤ ì¸í„°í˜ì´ìŠ¤ì—ì„œ ë§ˆì¼€í„°ê°€ ì‰½ê²Œ ì„¤ì •

```javascript
// ì¡°ê±´ íƒ€ì…ë³„ ì„¤ì • ì˜ˆì‹œ
const conditionTypes = {
	equal: 'ì •í™•íˆ ì¼ì¹˜', // level = 5
	under: 'ë¯¸ë§Œ', // water_pot < 10
	over: 'ì´ˆê³¼', // nutrient > 100
}

// ì‹œê°„ ì„¤ì • ì˜ˆì‹œ
const timeSettings = {
	repeat_days: ['Mon', 'Wed', 'Fri'], // ì›”,ìˆ˜,ê¸ˆë§Œ
	repeat_start_time: '1000', // ì˜¤ì „ 10ì‹œë¶€í„°
	repeat_end_time: '1500', // ì˜¤í›„ 3ì‹œê¹Œì§€
}

// ë“±ë“±...
```

ì•„ë˜ëŠ” ë¶€ë””ë² ì´ìŠ¤ì˜ ë°ì´í„° í˜•íƒœë‹¤.
![budi-01](/assets/img/budi-01.png)
![budi-02](/assets/img/budi-02.png)



## ğŸ“ˆ ì„±ê³¼ ë° íš¨ê³¼

- **ë§ˆì¼€íŒ… íš¨ìœ¨ì„± ëŒ€í­ ê°œì„ **
- **ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ**
- **ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •**
- **ê°œë°œíŒ€ ì—…ë¬´ íš¨ìœ¨ì„± ê°œì„ **


## ğŸ”š ë§ˆë¬´ë¦¬

ì´ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ **"ê¸°ìˆ ì€ ì‚¬ìš©ìë¥¼ ìœ„í•œ ê²ƒ"**ì´ë¼ëŠ” ê²ƒì„ ë‹¤ì‹œ í•œë²ˆ ê¹¨ë‹¬ì•˜ë‹¤. ë§ˆì¼€í„°ë„ ì‚¬ìš©ìì´ê³ , ê²Œì„ ìœ ì €ë„ ì‚¬ìš©ìë‹¤. ë‘ ì‚¬ìš©ì ëª¨ë‘ë¥¼ ë§Œì¡±ì‹œí‚¤ëŠ” ì‹œìŠ¤í…œì„ ë§Œë“œëŠ” ê²ƒì´ ì§„ì •í•œ ì„±ê³µì´ì—ˆë‹¤.

---
